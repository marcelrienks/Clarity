version: 1
name: "Key Present Panel Switch Test"
description: "Test key present trigger functionality and panel switching with green key icon"
timeout: 60000

steps:
  - name: "Initial oil panel startup"
    wait: 4000
    
  - name: "Verify oil panel loaded"
    expect_text: "Oil panel"
    timeout: 2000
    
  # Manual interaction required:
  # Toggle DIP Switch #1 ON to activate key present trigger
  
  - name: "Wait for key present trigger activation"
    wait: 2000
    
  - name: "Look for panel switch to key panel"
    expect_text: "KeyPanel"
    timeout: 5000
    optional: true
    
  - name: "Capture key panel state"
    screenshot: "key_panel_green_icon.png"
    delay: 2000
    
  # Manual interaction required:
  # Toggle DIP Switch #1 OFF to deactivate key present trigger
  
  - name: "Wait for key trigger deactivation"
    wait: 2000
    
  - name: "Look for return to oil panel"
    expect_text: "OemOilPanel"
    timeout: 3000
    optional: true
    
  - name: "Final state capture"
    screenshot: "key_test_complete.png"
    delay: 1000

# Manual test procedure:
# 1. Start with all DIP switches OFF
# 2. Toggle DIP #1 ON -> Key panel with GREEN icon
# 3. Toggle DIP #1 OFF -> Return to oil panel
# 4. Verify smooth transitions and no errors

expect_patterns:
  - "[INFO] Trigger key_present"
  - "Load KeyPanel"
  - "OemOilPanel"

fail_patterns:
  - "[ERROR]"
  - "Exception"
  - "crash"